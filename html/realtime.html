<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<html> 
 <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
    <title>Flot Examples</title> 
    <!-- <link href="layout.css" rel="stylesheet" type="text/css"> 
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]--> 
    <script language="javascript" type="text/javascript" src="./js/jquery-1.6.1.min.js"></script> 
    <script language="javascript" type="text/javascript" src="./js/flot/jquery.flot.js"></script> 
 </head> 
    <body> 
    <h1>Flot Examples</h1> 
 
    <div id="placeholder" style="width:600px;height:300px;"></div> 
 
    <p>You can update a chart periodically to get a real-time effect
    by using a timer to insert the new data in the plot and redraw it.</p> 
 
    <p>Time between updates: <input id="updateInterval" type="text" value="" style="text-align: right; width:5em"> milliseconds</p> 


<script type="text/javascript"> 
$(function () {
    // we use an inline data source in the example, usually data would
    // be fetched from a serve
	var d = [];

	// then fetch the data with jQuery
        

	function hist(series) {
            // extract the first coordinate pair so you can see that
            // data is now an ordinary Javascript object
            //var firstcoordinate = '(' + series.data[0][0] + ', ' + series.data[0][1] + ')';
 		//alert(firstcoordinate);
            d = [];
	    d.push(series);
            
            // and plot all we got
            //$.plot($("#placeholder"), [{ d, lines:{show: false}, points: { show: true} }], options);
       var options = {
                  series: {
                  lines: { show: false },
                  points: { show: true }
                  }
                };
		$.plot($("#placeholder"), d , options);
         }    



    function getRandomData() {

	//var mydata = $.ajax({
 	//	url: "http://localhost:8765/read_some_more_data",
  	//	async: false,
	//	dataType: "jsonp",
 	//}).responseText

	//$.ajax({
         //   url: "http://localhost:8765/read_some_more_data_json?callback=?",
          //  method: 'GET',
	//	async: false,
        //    dataType: 'jsonp'
        //});

	$.getJSON("http://localhost:8765/read_some_more_data_json;callback=?",
    		function(data1){  hist(data1) }
	);
	
	

    }
 
    // setup control widget
    var updateInterval = 1000;
    $("#updateInterval").val(updateInterval).change(function () {
        var v = $(this).val();
        if (v && !isNaN(+v)) {
            updateInterval = +v;
            if (updateInterval < 1)
                updateInterval = 1;
            if (updateInterval > 2000)
                updateInterval = 2000;
            $(this).val("" + updateInterval);
        }
    });
 
    // setup plot
    var options = {
        series: { shadowSize: 0 }, // drawing is faster without shadows
        xaxis: { show: true }
    };
    //var plot = $.plot($("#placeholder"),  getRandomData() , options);
 
    function update() {
        //plot.setData( getRandomData() );
        // since the axes don't change, we don't need to call plot.setupGrid()
        //plot.draw();
        
	getRandomData();
        setTimeout(update, updateInterval);
    }
 
    update();
});
</script> 
 
 </body> 
</html> 

